<ul class="timeline">
    {% for post in site.posts %}
        {% if post.category == 'destinations' or post.category == 'updates' %}
            {% if post.category == 'destinations' %}
                {% assign icon = 'fas fa-campground' %}
                {% assign color = 'success' %}

                {% for destination_post in site.categories.destinations %}
                    {% if destination_post.url == post.url %}
                        {% assign post_index0 = forloop.index0 %}
                        {% assign post_index1 = forloop.index %}
                    {% endif %}
                {% endfor %}

                {% for destination_post in site.categories.destinations %}
                    {% if post_index0 == forloop.index %}
                        {% assign next_destination = destination_post %}
                    {% endif %}
                    {% if post_index1 == forloop.index0 %}
                        {% assign prev_destination = destination_post %}
                    {% endif %}
                {% endfor %}
            {% elsif post.category == 'updates' %}
                {% assign icon = 'fas fa-hiking' %}
                {% assign color = 'info' %}
            {% endif %}

            <li>
                <div class="timeline-badge {{ color }}">
                    <i class="{{ icon }}"></i>
                </div>
                <div class="timeline-panel">
                <div class="timeline-heading">
                    <h4 class="timeline-title">
                        <a href="{{ post.url}}">{{ post.title }}</a>
                    </h4>
                    <p><small class="text-muted"><i class="fa fa-clock"></i> {{ post.date | date: "%A, %B %e, %Y" }}</small></p>
                </div>
                <div class="timeline-body">
                    {% if post.category == 'destinations' %}
                    <p>
                        {% if prev_destination %}
                            {{ post.miles | floor }} miles from {{ prev_destination.city }}. 
                        {% endif %}
                        {% if post.nights %}
                            Stayed {{ post.nights }} {% if post.nights == 1 %} night. {% else %} nights. {% endif %} 
                        {% endif %}
                    </p>
                    {% endif %}
                    {% for tag in post.tags %}
                        {% if prev_destination and tag != prev_destination.update_tag %}
                            <span class="badge badge-info mt-4">{{ tag }}</span> 
                        {% endif %}
                    {% endfor %}
                </div>
                </div>
            </li>
        {% endif %}
    {% endfor %}
</ul>